2025-09-05 21:51:27 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Starting WarehouseDataIngestionServiceApplication using Java 21 with PID 25725 (/Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service/target/classes started by mertunsal in /Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service)
2025-09-05 21:51:27 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - The following 4 profiles are active: "default", "logging", "management", "kafka"
2025-09-05 21:51:27 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 21:51:27 [main] INFO  [] [] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 21:51:27 [main] INFO  [] [] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-05 21:51:27 [main] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 21:51:27 [main] INFO  [] [] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 898 ms
2025-09-05 21:51:28 [main] INFO  [] [] o.s.v.beanvalidation.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-09-05 21:51:28 [main] INFO  [] [] o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 7 endpoints beneath base path '/actuator'
2025-09-05 21:51:28 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-09-05 21:51:28 [main] INFO  [] [] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Kafka consumer tracing interceptor configured
2025-09-05 21:51:28 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Started WarehouseDataIngestionServiceApplication in 2.043 seconds (process running for 2.955)
2025-09-05 21:51:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:28 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:28 [RMI TCP Connection(6)-127.0.0.1] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-05 21:51:28 [RMI TCP Connection(6)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-05 21:51:28 [RMI TCP Connection(6)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 2 ms
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:29 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:30 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:32 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:33 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:33 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:34 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:35 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:36 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:37 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:38 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:39 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:40 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Connection to node -1 (localhost/127.0.0.1:9092) could not be established. Node may not be available.
2025-09-05 21:51:40 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] Bootstrap broker localhost:9092 (id: -1 rack: null) disconnected
2025-09-05 21:51:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Kafka consumer tracing interceptor closed
2025-09-05 21:51:41 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: Consumer stopped
2025-09-05 21:51:41 [SpringApplicationShutdownHook] INFO  [] [] o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-05 21:51:41 [tomcat-shutdown] INFO  [] [] o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-05 22:00:09 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Starting WarehouseDataIngestionServiceApplication using Java 21 with PID 26046 (/Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service/target/classes started by mertunsal in /Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service)
2025-09-05 22:00:09 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - The following 4 profiles are active: "default", "logging", "management", "kafka"
2025-09-05 22:00:10 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 22:00:10 [main] INFO  [] [] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 22:00:10 [main] INFO  [] [] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-05 22:00:10 [main] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 22:00:10 [main] INFO  [] [] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 852 ms
2025-09-05 22:00:11 [main] INFO  [] [] o.s.v.beanvalidation.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-09-05 22:00:11 [main] INFO  [] [] o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 7 endpoints beneath base path '/actuator'
2025-09-05 22:00:11 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-09-05 22:00:11 [main] INFO  [] [] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Kafka consumer tracing interceptor configured
2025-09-05 22:00:11 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Started WarehouseDataIngestionServiceApplication in 1.995 seconds (process running for 3.71)
2025-09-05 22:00:11 [RMI TCP Connection(3)-127.0.0.1] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-05 22:00:11 [RMI TCP Connection(3)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-05 22:00:11 [RMI TCP Connection(3)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-05 22:00:11 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] WARN  [] [] org.apache.kafka.clients.NetworkClient - [Consumer clientId=consumer-warehouse-group-1, groupId=warehouse-group] The metadata response from the cluster reported a recoverable issue with correlation id 2 : {warehouse-events=UNKNOWN_TOPIC_OR_PARTITION}
2025-09-05 22:00:12 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: partitions assigned: [warehouse-events-0]
2025-09-05 22:02:52 [http-nio-8080-exec-1] ERROR [] [] c.i.w.exception.GlobalExceptionHandler - Unexpected exception occurred: No static resource .
org.springframework.web.servlet.resource.NoResourceFoundException: No static resource .
	at org.springframework.web.servlet.resource.ResourceHttpRequestHandler.handleRequest(ResourceHttpRequestHandler.java:585)
	at org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter.handle(HttpRequestHandlerAdapter.java:52)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.ServerHttpObservationFilter.doFilterInternal(ServerHttpObservationFilter.java:110)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1769)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-05 22:02:59 [http-nio-8080-exec-2] INFO  [] [] org.springdoc.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 153 ms
2025-09-05 22:05:46 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: partitions revoked: [warehouse-events-0]
2025-09-05 22:05:50 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Starting WarehouseDataIngestionServiceApplication using Java 21 with PID 26334 (/Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service/target/classes started by mertunsal in /Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service)
2025-09-05 22:05:50 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - The following 4 profiles are active: "default", "logging", "management", "kafka"
2025-09-05 22:05:51 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 22:05:51 [main] INFO  [] [] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 22:05:51 [main] INFO  [] [] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-05 22:05:51 [main] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 22:05:51 [main] INFO  [] [] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1456 ms
2025-09-05 22:05:52 [main] INFO  [] [] o.s.v.beanvalidation.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-09-05 22:05:52 [main] INFO  [] [] o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 7 endpoints beneath base path '/actuator'
2025-09-05 22:05:52 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-09-05 22:05:52 [main] INFO  [] [] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Kafka consumer tracing interceptor configured
2025-09-05 22:05:52 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Started WarehouseDataIngestionServiceApplication in 3.222 seconds (process running for 4.143)
2025-09-05 22:05:53 [RMI TCP Connection(11)-127.0.0.1] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-05 22:05:53 [RMI TCP Connection(11)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-05 22:05:53 [RMI TCP Connection(11)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-09-05 22:05:53 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: partitions assigned: [warehouse-events-0]
2025-09-05 22:06:00 [http-nio-8080-exec-4] INFO  [] [] org.springdoc.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 214 ms
2025-09-05 22:11:24 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: partitions revoked: [warehouse-events-0]
2025-09-05 22:11:28 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Starting WarehouseDataIngestionServiceApplication using Java 21 with PID 26821 (/Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service/target/classes started by mertunsal in /Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service)
2025-09-05 22:11:28 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - The following 4 profiles are active: "default", "logging", "management", "kafka"
2025-09-05 22:11:29 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 22:11:29 [main] INFO  [] [] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 22:11:29 [main] INFO  [] [] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-05 22:11:29 [main] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 22:11:29 [main] INFO  [] [] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1267 ms
2025-09-05 22:11:30 [main] INFO  [] [] o.s.v.beanvalidation.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-09-05 22:11:30 [main] INFO  [] [] o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 7 endpoints beneath base path '/actuator'
2025-09-05 22:11:30 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-09-05 22:11:30 [main] INFO  [] [] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Kafka consumer tracing interceptor configured
2025-09-05 22:11:30 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Started WarehouseDataIngestionServiceApplication in 2.987 seconds (process running for 3.928)
2025-09-05 22:11:31 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: partitions assigned: [warehouse-events-0]
2025-09-05 22:11:31 [RMI TCP Connection(11)-127.0.0.1] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-05 22:11:31 [RMI TCP Connection(11)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-05 22:11:31 [RMI TCP Connection(11)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-09-05 22:11:43 [http-nio-8080-exec-3] INFO  [] [] org.springdoc.api.AbstractOpenApiResource - Init duration for springdoc-openapi is: 304 ms
2025-09-05 22:12:00 [http-nio-8080-exec-6] INFO  [c507211dd2314853a9cf6aee792e28ae] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.config.TracingInterceptor - Request started - Method: POST, URI: /api/v1/inventory/upload, TraceId: c507211dd2314853a9cf6aee792e28ae, Operation: POST__API_V1_INVENTORY_UPLOAD
2025-09-05 22:12:00 [http-nio-8080-exec-6] INFO  [c507211dd2314853a9cf6aee792e28ae] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.controller.InventoryController - Starting inventory file upload - filename: inventory.json, size: 331 bytes, traceId: c507211dd2314853a9cf6aee792e28ae
2025-09-05 22:12:00 [http-nio-8080-exec-6] INFO  [c507211dd2314853a9cf6aee792e28ae] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.controller.InventoryController - Successfully parsed inventory file - 4 articles found, traceId: c507211dd2314853a9cf6aee792e28ae
2025-09-05 22:12:00 [http-nio-8080-exec-6] INFO  [c507211dd2314853a9cf6aee792e28ae] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.config.kafka.KafkaProducerTracingInterceptor - Kafka producer tracing interceptor configured
2025-09-05 22:12:00 [http-nio-8080-exec-6] INFO  [c507211dd2314853a9cf6aee792e28ae] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.controller.InventoryController - Inventory upload completed successfully - 4 articles processed, traceId: c507211dd2314853a9cf6aee792e28ae
2025-09-05 22:12:00 [http-nio-8080-exec-6] INFO  [c507211dd2314853a9cf6aee792e28ae] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.config.TracingInterceptor - Request completed successfully - Method: POST, URI: /api/v1/inventory/upload, Status: 200, TraceId: c507211dd2314853a9cf6aee792e28ae
2025-09-05 22:12:00 [kafka-producer-network-thread | warehouse-data-ingestion-service-producer-1] INFO  [1181de83ff914404ada82bbc88d50043] [] c.i.w.service.KafkaProducerService - Sent message=[InventoryData] with key=[inventory] to topic=[warehouse-events] with offset=[0]
2025-09-05 22:12:00 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Processing Kafka message - Topic: warehouse-events, Partition: 0, Offset: 0, TraceId: c507211dd2314853a9cf6aee792e28ae, Operation: KAFKA_CONSUME_WAREHOUSE-EVENTS, ValueType: LinkedHashMap
2025-09-05 22:12:00 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] ERROR [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] o.s.kafka.listener.DefaultErrorHandler - Backoff FixedBackOff{interval=0, currentAttempts=1, maxAttempts=0} exhausted for warehouse-events-0@0
org.springframework.kafka.listener.ListenerExecutionFailedException: Listener method could not be invoked with the incoming message
Endpoint handler details:
Method [public void com.ikea.warehouse_data_ingestion_service.service.KafkaConsumerService.listen(java.lang.String)]
Bean [com.ikea.warehouse_data_ingestion_service.service.KafkaConsumerService@364ce654]
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.decorateException(KafkaMessageListenerContainer.java:2994)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2901)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2865)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2777)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2614)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2503)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2152)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1528)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1466)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1335)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java)
	at java.base/java.lang.Thread.run(Thread.java:1583)
	Suppressed: org.springframework.kafka.listener.ListenerExecutionFailedException: Restored Stack Trace
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.checkAckArg(MessagingMessageListenerAdapter.java:500)
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:479)
		at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
		at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
		at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2887)
Caused by: org.springframework.messaging.converter.MessageConversionException: Cannot handle message
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:479)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2887)
	... 11 common frames omitted
Caused by: org.springframework.messaging.converter.MessageConversionException: Cannot convert from [java.util.LinkedHashMap] to [java.lang.String] for GenericMessage [payload={inventory=[{art_id=1, name=leg, stock=12}, {art_id=2, name=screw, stock=17}, {art_id=3, name=seat, stock=2}, {art_id=4, name=table top, stock=1}]}, headers={X-Timestamp=[B@3a7cbf2b, kafka_offset=0, kafka_consumer=org.springframework.kafka.core.DefaultKafkaConsumerFactory$ExtendedKafkaConsumer@51f5bc5a, kafka_timestampType=CREATE_TIME, kafka_receivedPartitionId=0, kafka_receivedMessageKey=inventory, kafka_receivedTopic=warehouse-events, kafka_receivedTimestamp=1757103120325, kafka_groupId=warehouse-group, X-Trace-Id=[B@5b6369f8}]
	at org.springframework.messaging.handler.annotation.support.PayloadMethodArgumentResolver.resolveArgument(PayloadMethodArgumentResolver.java:151)
	at org.springframework.kafka.listener.adapter.KafkaNullAwarePayloadArgumentResolver.resolveArgument(KafkaNullAwarePayloadArgumentResolver.java:48)
	at org.springframework.messaging.handler.invocation.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:118)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:147)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:115)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:78)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:475)
	... 15 common frames omitted
2025-09-05 22:16:54 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: partitions revoked: [warehouse-events-0]
2025-09-05 22:16:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Kafka consumer tracing interceptor closed
2025-09-05 22:16:55 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-group: Consumer stopped
2025-09-05 22:16:55 [SpringApplicationShutdownHook] INFO  [] [] o.s.boot.web.embedded.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-09-05 22:16:55 [tomcat-shutdown] INFO  [] [] o.s.boot.web.embedded.tomcat.GracefulShutdown - Graceful shutdown complete
2025-09-05 22:16:55 [SpringApplicationShutdownHook] INFO  [] [] c.i.w.config.kafka.KafkaProducerTracingInterceptor - Kafka producer tracing interceptor closed
2025-09-05 22:17:10 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Starting WarehouseDataIngestionServiceApplication using Java 21 with PID 27119 (/Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service/target/classes started by mertunsal in /Users/mertunsal/Workspace/java/ikea/warehouse-data-ingestion-service)
2025-09-05 22:17:10 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - The following 4 profiles are active: "default", "logging", "management", "kafka"
2025-09-05 22:17:11 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-09-05 22:17:11 [main] INFO  [] [] org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-09-05 22:17:11 [main] INFO  [] [] org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.44]
2025-09-05 22:17:11 [main] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-09-05 22:17:11 [main] INFO  [] [] o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 950 ms
2025-09-05 22:17:11 [main] INFO  [] [] o.s.v.beanvalidation.OptionalValidatorFactoryBean - Failed to set up a Bean Validation provider: jakarta.validation.NoProviderFoundException: Unable to create a Configuration, because no Jakarta Bean Validation provider could be found. Add a provider like Hibernate Validator (RI) to your classpath.
2025-09-05 22:17:12 [main] INFO  [] [] o.s.b.actuate.endpoint.web.EndpointLinksResolver - Exposing 7 endpoints beneath base path '/actuator'
2025-09-05 22:17:12 [main] INFO  [] [] o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/'
2025-09-05 22:17:12 [main] INFO  [] [] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Kafka consumer tracing interceptor configured
2025-09-05 22:17:12 [main] INFO  [] [] c.i.w.WarehouseDataIngestionServiceApplication - Started WarehouseDataIngestionServiceApplication in 2.506 seconds (process running for 3.356)
2025-09-05 22:17:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [] [] o.s.kafka.listener.KafkaMessageListenerContainer - warehouse-ingestion-group: partitions assigned: [warehouse-events-0]
2025-09-05 22:17:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Processing Kafka message - Topic: warehouse-events, Partition: 0, Offset: 0, TraceId: c507211dd2314853a9cf6aee792e28ae, Operation: KAFKA_CONSUME_WAREHOUSE-EVENTS, ValueType: LinkedHashMap
2025-09-05 22:17:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.service.KafkaConsumerService - Received Kafka message with key: inventory, type: ConsumerRecord, traceId: c507211dd2314853a9cf6aee792e28ae
2025-09-05 22:17:13 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] ERROR [c507211dd2314853a9cf6aee792e28ae] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.service.KafkaConsumerService - Error processing inventory message, traceId: c507211dd2314853a9cf6aee792e28ae, error: Unexpected message type: class org.apache.kafka.clients.consumer.ConsumerRecord
java.lang.IllegalArgumentException: Unexpected message type: class org.apache.kafka.clients.consumer.ConsumerRecord
	at com.ikea.warehouse_data_ingestion_service.service.KafkaConsumerService.handleInventoryMessage(KafkaConsumerService.java:65)
	at com.ikea.warehouse_data_ingestion_service.service.KafkaConsumerService.listen(KafkaConsumerService.java:41)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:78)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:475)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2887)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2865)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2777)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2614)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2503)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2152)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1528)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1466)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1335)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-05 22:17:13 [RMI TCP Connection(4)-127.0.0.1] INFO  [] [] o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-09-05 22:17:13 [RMI TCP Connection(4)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-09-05 22:17:13 [RMI TCP Connection(4)-127.0.0.1] INFO  [] [] org.springframework.web.servlet.DispatcherServlet - Completed initialization in 3 ms
2025-09-05 22:17:51 [http-nio-8080-exec-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.config.TracingInterceptor - Request started - Method: POST, URI: /api/v1/inventory/upload, TraceId: 3f10ab9713d64dfc878a29af165f108e, Operation: POST__API_V1_INVENTORY_UPLOAD
2025-09-05 22:17:51 [http-nio-8080-exec-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.controller.InventoryController - Starting inventory file upload - filename: inventory.json, size: 331 bytes, traceId: 3f10ab9713d64dfc878a29af165f108e
2025-09-05 22:17:51 [http-nio-8080-exec-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.controller.InventoryController - Successfully parsed inventory file - 4 articles found, traceId: 3f10ab9713d64dfc878a29af165f108e
2025-09-05 22:17:51 [http-nio-8080-exec-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.config.kafka.KafkaProducerTracingInterceptor - Kafka producer tracing interceptor configured
2025-09-05 22:17:51 [http-nio-8080-exec-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.controller.InventoryController - Inventory upload completed successfully - 4 articles processed, traceId: 3f10ab9713d64dfc878a29af165f108e
2025-09-05 22:17:51 [http-nio-8080-exec-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [POST__API_V1_INVENTORY_UPLOAD] c.i.w.config.TracingInterceptor - Request completed successfully - Method: POST, URI: /api/v1/inventory/upload, Status: 200, TraceId: 3f10ab9713d64dfc878a29af165f108e
2025-09-05 22:17:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.config.kafka.KafkaConsumerTracingInterceptor - Processing Kafka message - Topic: warehouse-events, Partition: 0, Offset: 1, TraceId: 3f10ab9713d64dfc878a29af165f108e, Operation: KAFKA_CONSUME_WAREHOUSE-EVENTS, ValueType: LinkedHashMap
2025-09-05 22:17:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] INFO  [3f10ab9713d64dfc878a29af165f108e] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.service.KafkaConsumerService - Received Kafka message with key: inventory, type: ConsumerRecord, traceId: 3f10ab9713d64dfc878a29af165f108e
2025-09-05 22:17:51 [org.springframework.kafka.KafkaListenerEndpointContainer#0-0-C-1] ERROR [3f10ab9713d64dfc878a29af165f108e] [KAFKA_CONSUME_WAREHOUSE-EVENTS] c.i.w.service.KafkaConsumerService - Error processing inventory message, traceId: 3f10ab9713d64dfc878a29af165f108e, error: Unexpected message type: class org.apache.kafka.clients.consumer.ConsumerRecord
java.lang.IllegalArgumentException: Unexpected message type: class org.apache.kafka.clients.consumer.ConsumerRecord
	at com.ikea.warehouse_data_ingestion_service.service.KafkaConsumerService.handleInventoryMessage(KafkaConsumerService.java:65)
	at com.ikea.warehouse_data_ingestion_service.service.KafkaConsumerService.listen(KafkaConsumerService.java:41)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:169)
	at org.springframework.kafka.listener.adapter.KotlinAwareInvocableHandlerMethod.doInvoke(KotlinAwareInvocableHandlerMethod.java:45)
	at org.springframework.messaging.handler.invocation.InvocableHandlerMethod.invoke(InvocableHandlerMethod.java:119)
	at org.springframework.kafka.listener.adapter.HandlerAdapter.invoke(HandlerAdapter.java:78)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invokeHandler(MessagingMessageListenerAdapter.java:475)
	at org.springframework.kafka.listener.adapter.MessagingMessageListenerAdapter.invoke(MessagingMessageListenerAdapter.java:421)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:85)
	at org.springframework.kafka.listener.adapter.RecordMessagingMessageListenerAdapter.onMessage(RecordMessagingMessageListenerAdapter.java:50)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeOnMessage(KafkaMessageListenerContainer.java:2887)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeOnMessage(KafkaMessageListenerContainer.java:2865)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeRecordListener(KafkaMessageListenerContainer.java:2777)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.doInvokeWithRecords(KafkaMessageListenerContainer.java:2614)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeRecordListener(KafkaMessageListenerContainer.java:2503)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeListener(KafkaMessageListenerContainer.java:2152)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.invokeIfHaveRecords(KafkaMessageListenerContainer.java:1528)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.pollAndInvoke(KafkaMessageListenerContainer.java:1466)
	at org.springframework.kafka.listener.KafkaMessageListenerContainer$ListenerConsumer.run(KafkaMessageListenerContainer.java:1335)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run$$$capture(CompletableFuture.java:1804)
	at java.base/java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java)
	at java.base/java.lang.Thread.run(Thread.java:1583)
2025-09-05 22:17:51 [kafka-producer-network-thread | warehouse-data-ingestion-service-producer-1] INFO  [0f93be3a1ceb4535b598030304f6a9fc] [] c.i.w.service.KafkaProducerService - Sent message=[InventoryData] with key=[inventory] to topic=[warehouse-events] with offset=[1]
